<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animal Personality Test - Discover Your True Nature</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

      body {
    font-family: 'Segoe UI', 'Arial', sans-serif;
    background: url('https://images.pexels.com/photos/338936/pexels-photo-338936.jpeg?cs=srgb&dl=pexels-nejc-kosir-108379-338936.jpg&fm=jpg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    min-height: 100vh;
    color: #333;
    overflow-x: hidden;
    position: relative;
}

        .background-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 3rem;
            color: white;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.4);
            margin-bottom: 15px;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .subtitle {
            font-size: 1.3rem;
            color: rgba(255,255,255,0.95);
            margin-bottom: 25px;
            font-weight: 300;
        }

        .game-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 15px 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        .stat-label {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .progress-container {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 8px;
            margin-bottom: 25px;
            backdrop-filter: blur(10px);
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #48bb78, #38a169, #68d391);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .round-info {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .round-title {
            font-size: 2rem;
            color: #2d3748;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .round-instructions {
            font-size: 1.15rem;
            color: #4a5568;
            line-height: 1.7;
            margin-bottom: 15px;
        }

        .round-tip {
            background: linear-gradient(135deg, #e6fffa, #b2f5ea);
            border-left: 4px solid #38b2ac;
            padding: 12px 15px;
            border-radius: 8px;
            font-size: 0.95rem;
            color: #234e52;
            font-style: italic;
        }

        .game-area {
            display: grid;
            grid-template-columns: 1.2fr 2fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .animals-pool {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            min-height: 450px;
            border: 1px solid rgba(255,255,255,0.5);
        }

        .pool-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .pool-title {
            font-size: 1.4rem;
            color: #2d3748;
            font-weight: 600;
        }

        .animals-count {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .animals-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: flex-start;
            max-height: 350px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .animals-container::-webkit-scrollbar {
            width: 6px;
        }

        .animals-container::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.1);
            border-radius: 3px;
        }

        .animals-container::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 3px;
        }

        .animal-item {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border: 2px solid rgba(255,255,255,0.8);
            border-radius: 25px;
            padding: 14px 20px;
            cursor: grab;
            user-select: none;
            font-weight: 600;
            color: #8b4513;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 20px rgba(0,0,0,0.12);
            position: relative;
            overflow: hidden;
            font-size: 1rem;
            white-space: nowrap;
        }

        .animal-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.6s ease;
        }

        .animal-item:hover::before {
            left: 100%;
        }

        .animal-item:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 8px 30px rgba(0,0,0,0.18);
            border-color: #667eea;
        }

        .animal-item:active {
            cursor: grabbing;
            transform: scale(0.98);
        }

        .animal-item.dragging {
            opacity: 0.8;
            transform: rotate(5deg) scale(1.05);
            z-index: 1000;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .drop-zones {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .drop-zone {
            background: rgba(255,255,255,0.9);
            border: 3px dashed #cbd5e0;
            border-radius: 20px;
            padding: 25px;
            min-height: 140px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            backdrop-filter: blur(5px);
        }

        .drop-zone::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 17px;
            background: linear-gradient(135deg, transparent, rgba(255,255,255,0.1));
            pointer-events: none;
        }

        .drop-zone.drag-over {
            border-color: #48bb78;
            background: rgba(72, 187, 120, 0.15);
            transform: scale(1.02);
            box-shadow: 0 10px 30px rgba(72, 187, 120, 0.2);
        }

        .drop-zone-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            margin-bottom: 15px;
        }

        .drop-zone-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .zone-count {
            background: rgba(0,0,0,0.1);
            color: #4a5568;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            min-width: 25px;
            text-align: center;
        }

        .dropped-animals {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            width: 100%;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 35px;
            border: none;
            border-radius: 30px;
            font-size: 1.05rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #8b4513;
        }

        .btn-danger {
            background: linear-gradient(135deg, #fc8181 0%, #e53e3e 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .btn:disabled::before {
            display: none;
        }

        .results-screen {
            display: none;
            text-align: center;
        }

        .results-card {
            background: rgba(255,255,255,0.95);
            border-radius: 25px;
            padding: 45px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.15);
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.5);
        }

        .personality-type {
            font-size: 2.8rem;
            color: #2d3748;
            margin-bottom: 25px;
            font-weight: 700;
        }

        .personality-description {
            font-size: 1.25rem;
            color: #4a5568;
            line-height: 1.8;
            margin-bottom: 35px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .scores-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }

        .score-item {
            background: rgba(255,255,255,0.9);
            border-radius: 18px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .score-item:hover {
            transform: translateY(-3px);
        }

        .score-label {
            font-size: 1.15rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 12px;
        }

        .score-bar {
            width: 100%;
            height: 12px;
            background: rgba(0,0,0,0.1);
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 6px;
        }

        .score-percentage {
            font-size: 1rem;
            color: #4a5568;
            font-weight: 600;
        }

        .hidden {
            display: none;
        }

        /* Zone-specific styling */
        .zone-carnivore { border-color: #e53e3e; }
        .zone-omnivore { border-color: #dd6b20; }
        .zone-herbivore { border-color: #38a169; }
        .zone-domestic { border-color: #3182ce; }
        .zone-wild { border-color: #805ad5; }
        .zone-zoo { border-color: #d69e2e; }
        .zone-high { border-color: #9f7aea; }
        .zone-medium { border-color: #ed8936; }
        .zone-low { border-color: #4fd1c7; }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .title { font-size: 2.2rem; }
            .game-area { 
                grid-template-columns: 1fr; 
                gap: 20px; 
            }
            .controls { 
                flex-direction: column; 
                align-items: center; 
            }
            .btn { width: 200px; }
            .game-stats { gap: 15px; }
            .stat-item { padding: 10px 20px; }
        }

        /* Touch-friendly adjustments */
        @media (hover: none) {
            .animal-item:hover { transform: none; }
            .btn:hover { transform: none; }
        }

        /* Floating particles */
        .floating-particle {
            position: fixed;
            pointer-events: none;
            opacity: 0.6;
            z-index: -1;
        }

        /* Sound toggle */
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            border: none;
            border-radius: 50%;
            width: 55px;
            height: 55px;
            font-size: 22px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .sound-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        /* Skip tutorial button */
        .skip-tutorial {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .skip-tutorial:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Tutorial overlay */
        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tutorial-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 25px 80px rgba(0,0,0,0.3);
        }

        .tutorial-step {
            margin-bottom: 20px;
        }

        .tutorial-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .tutorial-text {
            font-size: 1.1rem;
            color: #4a5568;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="background-overlay"></div>
    
    <button class="skip-tutorial hidden" id="skip-tutorial">Skip Tutorial</button>
    
    <div class="tutorial-overlay hidden" id="tutorial-overlay">
        <div class="tutorial-content">
            <div class="tutorial-step" id="tutorial-step">
                <div class="tutorial-icon">🎯</div>
                <h3>Welcome to the Animal Personality Test!</h3>
                <p class="tutorial-text">Discover your true personality by sorting animals into different categories. Your choices reveal deep insights about your character.</p>
            </div>
            <button class="btn btn-primary" id="start-tutorial">Let's Begin!</button>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1 class="title">🐾 Animal Personality Test</h1>
            <p class="subtitle">Discover your true nature through animal categorization</p>
            
            <div class="game-stats">
                <div class="stat-item">
                    <div class="stat-value" id="current-round">1</div>
                    <div class="stat-label">Round</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="animals-sorted">0</div>
                    <div class="stat-label">Sorted</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="time-elapsed">0:00</div>
                    <div class="stat-label">Time</div>
                </div>
            </div>
        </div>

        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>

        <div id="game-screen">
            <div class="round-info">
                <h2 class="round-title" id="round-title">Round 1: Diet & Feeding</h2>
                <p class="round-instructions" id="round-instructions">
                    Sort these animals based on their primary diet. Drag each animal to the appropriate category.
                </p>
                <div class="round-tip" id="round-tip">
                    💡 Tip: Think about what these animals naturally eat in the wild, not what they might eat in captivity.
                </div>
            </div>

            <div class="game-area">
                <div class="animals-pool">
                    <div class="pool-header">
                        <h3 class="pool-title">🐾 Animals to Sort</h3>
                        <span class="animals-count" id="animals-count">15</span>
                    </div>
                    <div class="animals-container" id="animals-container">
                        </div>
                </div>

                <div class="drop-zones" id="drop-zones">
                    </div>
            </div>

            <div class="controls">
                <button class="btn btn-danger" id="reset-btn">🔄 Reset Round</button>
                <button class="btn btn-secondary" id="hint-btn">💡 Get Hint</button>
                <button class="btn btn-primary" id="next-btn" disabled>Next Round ➡</button>
            </div>
        </div>

        <div id="results-screen" class="results-screen hidden">
            <div class="results-card">
                <h2 class="personality-type" id="personality-type">Your Personality Type</h2>
                <p class="personality-description" id="personality-description">
                    Description of your personality based on your sorting choices.
                </p>
                
                <div class="scores-container" id="scores-container">
                    </div>

                <div class="controls">
                    <button class="btn btn-primary" id="play-again-btn">🎮 Play Again</button>
                    <button class="btn btn-secondary" id="share-btn">📱 Share Result</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced Game Configuration
        const ANIMALS = [
            '🦁 Lion', '🐘 Elephant', '🐕 Dog', '🐦 Crow', '🐰 Rabbit',
            '🦅 Eagle', '🦈 Shark', '🐄 Cow', '🐒 Monkey', '🐱 Cat',
            '🐎 Horse', '🦊 Fox', '🦌 Deer', '🐐 Goat', '🐬 Dolphin'
        ];

        const ROUNDS = [
            {
                title: "Round 1: Diet & Feeding Habits",
                instructions: "Sort these animals based on their primary diet. Think about what they naturally eat in the wild.",
                tip: "💡 Consider their natural hunting or foraging behaviors, not what they might eat in captivity.",
                categories: [
                    { name: "Carnivore", emoji: "🥩", class: "zone-carnivore", description: "Primarily eats meat" },
                    { name: "Omnivore", emoji: "🍽", class: "zone-omnivore", description: "Eats both plants and meat" },
                    { name: "Herbivore", emoji: "🌱", class: "zone-herbivore", description: "Primarily eats plants" }
                ],
                hints: {
                    "🦁 Lion": "Kings of the jungle are apex predators",
                    "🐄 Cow": "Peaceful grazers in meadows",
                    "🐒 Monkey": "Clever creatures that eat fruits, insects, and small animals"
                }
            },
            {
                title: "Round 2: Social Environment",
                instructions: "Categorize these animals by their typical relationship with humans and civilization.",
                tip: "💡 Think about where you're most likely to encounter these animals in real life.",
                categories: [
                    { name: "Domestic", emoji: "🏠", class: "zone-domestic", description: "Lives closely with humans" },
                    { name: "Wild", emoji: "🌲", class: "zone-wild", description: "Lives independently in nature" },
                    { name: "Zoo/Managed", emoji: "🎪", class: "zone-zoo", description: "Typically seen in managed environments" }
                ],
                hints: {
                    "🐕 Dog": "Humanity's best friend for thousands of years",
                    "🦁 Lion": "Majestic rulers of the African savanna",
                    "🐘 Elephant": "Gentle giants often protected in reserves"
                }
            },
            {
                title: "Round 3: Intelligence & Problem Solving",
                instructions: "Rate these animals based on your perception of their cognitive abilities and intelligence.",
                tip: "💡 Consider their ability to use tools, solve puzzles, and adapt to new situations.",
                categories: [
                    { name: "High Intelligence", emoji: "🧠", class: "zone-high", description: "Exceptional problem-solving abilities" },
                    { name: "Medium Intelligence", emoji: "🤔", class: "zone-medium", description: "Moderate cognitive abilities" },
                    { name: "Basic Intelligence", emoji: "💭", class: "zone-low", description: "Simple behavioral patterns" }
                ],
                hints: {
                    "🐬 Dolphin": "Ocean's Einstein with complex communication",
                    "🦊 Fox": "Cunning and adaptable survivors",
                    "🐰 Rabbit": "Simple but effective instinct-driven behavior"
                }
            },
            {
                title: "Round 4: Emotional Connection",
                instructions: "Sort based on which animals you feel most emotionally connected to or drawn towards.",
                tip: "💡 Trust your instincts - which animals make you feel warm and fuzzy inside?",
                categories: [
                    { name: "Strong Connection", emoji: "💝", class: "zone-high", description: "Animals you feel deeply connected to" },
                    { name: "Moderate Appeal", emoji: "😊", class: "zone-medium", description: "Animals you find pleasant" },
                    { name: "Neutral/Distant", emoji: "😐", class: "zone-low", description: "Animals you feel neutral about" }
                ],
                hints: {
                    "🐱 Cat": "Independent spirits that choose their own humans",
                    "🐎 Horse": "Noble companions throughout human history",
                    "🦈 Shark": "Misunderstood predators of the deep"
                }
            },
            {
                title: "Round 5: Leadership Qualities",
                instructions: "Categorize these animals based on their natural leadership and social hierarchy roles.",
                tip: "💡 Think about how these animals behave in groups and their natural social structures.",
                categories: [
                    { name: "Pack Leaders", emoji: "👑", class: "zone-carnivore", description: "Natural leaders and dominators" },
                    { name: "Team Players", emoji: "🤝", class: "zone-omnivore", description: "Collaborative and social" },
                    { name: "Followers", emoji: "👥", class: "zone-herbivore", description: "Prefer to follow others" }
                ],
                hints: {
                    "🦅 Eagle": "Soaring alone, commanding the skies",
                    "🐒 Monkey": "Social climbers with complex group dynamics",
                    "🦌 Deer": "Gentle creatures that move in herds"
                }
            },
            {
                title: "Round 6: Survival Strategy",
                instructions: "Think about how these animals survive challenges. What's their primary strategy?",
                tip: "💡 When faced with danger, what would each animal's first instinct be?",
                categories: [
                    { name: "Fight/Confront", emoji: "⚔", class: "zone-wild", description: "Face challenges head-on" },
                    { name: "Adapt/Outsmart", emoji: "🧩", class: "zone-zoo", description: "Use intelligence to overcome obstacles" },
                    { name: "Flee/Avoid", emoji: "💨", class: "zone-domestic", description: "Avoid confrontation when possible" }
                ],
                hints: {
                    "🦈 Shark": "Ancient predators built for confrontation",
                    "🦊 Fox": "Masters of adaptation and cunning",
                    "🐰 Rabbit": "Quick escape artists of the animal kingdom"
                }
            }
        ];

        // Personality types and descriptions
        const PERSONALITY_TYPES = {
            "The Guardian": {
                description: "You are protective, loyal, and value stability. Like a guardian animal, you prioritize safety and security for those you care about. You're dependable and have a strong sense of responsibility.",
                traits: ["Loyal", "Protective", "Dependable", "Stable"]
            },
            "The Explorer": {
                description: "You're curious, adventurous, and always seeking new experiences. Like an explorer animal, you thrive on discovery and aren't afraid to venture into the unknown.",
                traits: ["Curious", "Adventurous", "Independent", "Resourceful"]
            },
            "The Strategist": {
                description: "You're analytical, intelligent, and always thinking several steps ahead. Like a strategic animal, you approach challenges with careful planning and clever solutions.",
                traits: ["Analytical", "Intelligent", "Strategic", "Patient"]
            },
            "The Nurturer": {
                description: "You're compassionate, empathetic, and naturally caring. Like a nurturing animal, you find fulfillment in helping others and creating harmonious environments.",
                traits: ["Compassionate", "Empathetic", "Caring", "Supportive"]
            },
            "The Leader": {
                description: "You're confident, decisive, and naturally take charge. Like a leader animal, you inspire others and excel at guiding groups toward common goals.",
                traits: ["Confident", "Decisive", "Inspiring", "Responsible"]
            },
            "The Free Spirit": {
                description: "You're independent, unconventional, and value your freedom above all. Like a free-spirited animal, you resist constraints and follow your own path.",
                traits: ["Independent", "Unconventional", "Spontaneous", "Creative"]
            }
        };

        // Game state
        let gameState = {
            currentRound: 0,
            animalsSorted: 0,
            startTime: null,
            timerInterval: null,
            playerChoices: [],
            shuffledAnimals: []
        };

        // DOM Elements
        const elements = {
            currentRound: document.getElementById('current-round'),
            animalsSorted: document.getElementById('animals-sorted'),
            timeElapsed: document.getElementById('time-elapsed'),
            progressFill: document.getElementById('progress-fill'),
            roundTitle: document.getElementById('round-title'),
            roundInstructions: document.getElementById('round-instructions'),
            roundTip: document.getElementById('round-tip'),
            animalsCount: document.getElementById('animals-count'),
            animalsContainer: document.getElementById('animals-container'),
            dropZones: document.getElementById('drop-zones'),
            resetBtn: document.getElementById('reset-btn'),
            hintBtn: document.getElementById('hint-btn'),
            nextBtn: document.getElementById('next-btn'),
            gameScreen: document.getElementById('game-screen'),
            resultsScreen: document.getElementById('results-screen'),
            personalityType: document.getElementById('personality-type'),
            personalityDescription: document.getElementById('personality-description'),
            scoresContainer: document.getElementById('scores-container'),
            playAgainBtn: document.getElementById('play-again-btn'),
            shareBtn: document.getElementById('share-btn'),
            skipTutorial: document.getElementById('skip-tutorial'),
            tutorialOverlay: document.getElementById('tutorial-overlay'),
            startTutorial: document.getElementById('start-tutorial')
        };

        // Initialize the game
        function initGame() {
            // Start timer
            gameState.startTime = new Date();
            gameState.timerInterval = setInterval(updateTimer, 1000);
            
            // Start with first round
            startRound(0);
            
            // Set up event listeners
            setupEventListeners();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Game control buttons
            elements.resetBtn.addEventListener('click', resetRound);
            elements.hintBtn.addEventListener('click', showHint);
            elements.nextBtn.addEventListener('click', nextRound);
            elements.playAgainBtn.addEventListener('click', playAgain);
            elements.shareBtn.addEventListener('click', shareResults);
            
            // Tutorial controls
            elements.skipTutorial.addEventListener('click', skipTutorial);
            elements.startTutorial.addEventListener('click', startTutorial);
        }

        // Start a new round
        function startRound(roundIndex) {
            gameState.currentRound = roundIndex;
            const round = ROUNDS[roundIndex];
            
            // Update UI with round info
            elements.currentRound.textContent = roundIndex + 1;
            elements.roundTitle.textContent = round.title;
            elements.roundInstructions.textContent = round.instructions;
            elements.roundTip.textContent = round.tip;
            
            // Shuffle animals for this round
            gameState.shuffledAnimals = [...ANIMALS].sort(() => Math.random() - 0.5);
            elements.animalsCount.textContent = gameState.shuffledAnimals.length;
            
            // Clear previous content
            elements.animalsContainer.innerHTML = '';
            elements.dropZones.innerHTML = '';
            
            // Create animal items
            gameState.shuffledAnimals.forEach(animal => {
                const animalItem = document.createElement('div');
                animalItem.className = 'animal-item';
                animalItem.textContent = animal;
                animalItem.draggable = true;
                animalItem.setAttribute('data-animal', animal);
                
                // Add drag event listeners
                animalItem.addEventListener('dragstart', handleDragStart);
                animalItem.addEventListener('dragend', handleDragEnd);
                
                elements.animalsContainer.appendChild(animalItem);
            });
            
            // Create drop zones
            round.categories.forEach((category, index) => {
                const dropZone = document.createElement('div');
                // FIX: Used template literal for className
                dropZone.className = `drop-zone ${category.class}`;
                dropZone.setAttribute('data-category', category.name);
                
                dropZone.innerHTML = `
                    <div class="drop-zone-header">
                        <div class="drop-zone-title">
                            <span>${category.emoji}</span>
                            <span>${category.name}</span>
                        </div>
                        <span class="zone-count">0</span>
                    </div>
                    <div class="dropped-animals" data-category="${category.name}"></div>
                `;
                
                // Add drop event listeners
                dropZone.addEventListener('dragover', handleDragOver);
                dropZone.addEventListener('dragenter', handleDragEnter);
                dropZone.addEventListener('dragleave', handleDragLeave);
                dropZone.addEventListener('drop', handleDrop);
                
                elements.dropZones.appendChild(dropZone);
            });
            
            // Update progress bar
            updateProgressBar();
            
            // Disable next button until all animals are sorted
            elements.nextBtn.disabled = true;
        }

        // Drag and drop handlers
        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.getAttribute('data-animal'));
            e.target.classList.add('dragging');
            
            // Add visual feedback to all drop zones
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.add('drag-over');
            });
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            
            // Remove visual feedback from drop zones
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('drag-over');
            });
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDragEnter(e) {
            e.preventDefault();
            e.target.closest('.drop-zone').classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.target.closest('.drop-zone').classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            const dropZone = e.target.closest('.drop-zone');
            dropZone.classList.remove('drag-over');
            
            const animal = e.dataTransfer.getData('text/plain');
            const category = dropZone.getAttribute('data-category');
            
            // Find the animal item
            // FIX: Used template literal for querySelector string
            const animalItem = document.querySelector(`.animal-item[data-animal="${animal}"]`);
            
            if (animalItem && !animalItem.classList.contains('dropped')) {
                // Remove from animals container
                animalItem.remove();
                
                // Add to drop zone
                const droppedAnimalsContainer = dropZone.querySelector('.dropped-animals');
                const droppedAnimal = document.createElement('div');
                droppedAnimal.className = 'animal-item dropped';
                droppedAnimal.textContent = animal;
                droppedAnimal.setAttribute('data-animal', animal);
                droppedAnimalsContainer.appendChild(droppedAnimal);
                
                // Update counts
                gameState.animalsSorted++;
                elements.animalsSorted.textContent = gameState.animalsSorted;
                elements.animalsCount.textContent = parseInt(elements.animalsCount.textContent) - 1;
                
                // Update zone count
                const zoneCount = dropZone.querySelector('.zone-count');
                zoneCount.textContent = parseInt(zoneCount.textContent) + 1;
                
                // Record player choice
                gameState.playerChoices.push({
                    round: gameState.currentRound,
                    animal: animal,
                    category: category
                });
                
                // Check if all animals are sorted
                if (parseInt(elements.animalsCount.textContent) === 0) {
                    elements.nextBtn.disabled = false;
                }
                
                // Update progress bar
                updateProgressBar();
            }
        }

        // Update progress bar
        function updateProgressBar() {
            const totalAnimals = ANIMALS.length;
            const sortedAnimals = gameState.animalsSorted;
            const progressPercentage = (sortedAnimals / (totalAnimals * ROUNDS.length)) * 100;
            
            // FIX: Used template literal for style property
            elements.progressFill.style.width = `${progressPercentage}%`;
        }

        // Update timer
        function updateTimer() {
            const now = new Date();
            const elapsed = Math.floor((now - gameState.startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            
            // FIX: Used template literal for textContent
            elements.timeElapsed.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        // Reset current round
        function resetRound() {
            const animalsInRound = document.querySelectorAll('.dropped-animals .animal-item').length;
            gameState.animalsSorted -= animalsInRound;
            elements.animalsSorted.textContent = gameState.animalsSorted;
            startRound(gameState.currentRound);
        }

        // Show hint for current round
        function showHint() {
            const round = ROUNDS[gameState.currentRound];
            const hints = Object.keys(round.hints);
            const randomHintAnimal = hints[Math.floor(Math.random() * hints.length)];
            
            alert(`Hint: ${randomHintAnimal} - ${round.hints[randomHintAnimal]}`);
        }

        // Move to next round or show results
        function nextRound() {
            if (gameState.currentRound < ROUNDS.length - 1) {
                startRound(gameState.currentRound + 1);
            } else {
                showResults();
            }
        }

        // Show results screen
        function showResults() {
            // Stop timer
            clearInterval(gameState.timerInterval);
            
            // Calculate personality type
            const personalityType = calculatePersonality();
            const personality = PERSONALITY_TYPES[personalityType];
            
            // Update results screen
            elements.personalityType.textContent = personalityType;
            elements.personalityDescription.textContent = personality.description;
            
            // Create score bars
            elements.scoresContainer.innerHTML = '';
            personality.traits.forEach(trait => {
                const scoreItem = document.createElement('div');
                scoreItem.className = 'score-item';
                
                const randomScore = Math.floor(Math.random() * 40) + 60; // Random score between 60-100
                
                // FIX: Set initial width to 0% and store target score in a data attribute for animation
                scoreItem.innerHTML = `
                    <div class="score-label">${trait}</div>
                    <div class="score-bar">
                        <div class="score-fill" style="width: 0%;" data-score="${randomScore}"></div>
                    </div>
                    <div class="score-percentage">${randomScore}%</div>
                `;
                
                elements.scoresContainer.appendChild(scoreItem);
            });
            
            // FIX: Animate score bars after a short delay by setting their final width
            setTimeout(() => {
                document.querySelectorAll('.score-fill').forEach(fill => {
                    const score = fill.getAttribute('data-score');
                    fill.style.width = `${score}%`;
                });
            }, 100);
            
            // Show results screen
            elements.gameScreen.classList.add('hidden');
            elements.resultsScreen.classList.remove('hidden');
            elements.resultsScreen.style.display = 'block';
        }

        // Calculate personality type based on player choices
        function calculatePersonality() {
            // Simple algorithm: count category preferences across rounds
            const categoryCounts = {};
            
            gameState.playerChoices.forEach(choice => {
                if (!categoryCounts[choice.category]) {
                    categoryCounts[choice.category] = 0;
                }
                categoryCounts[choice.category]++;
            });
            
            // Determine personality type based on most frequent categories
            // NOTE: This logic remains random as per the original code.
            const personalityTypes = Object.keys(PERSONALITY_TYPES);
            const randomType = personalityTypes[Math.floor(Math.random() * personalityTypes.length)];
            
            return randomType;
        }

        // Play again
        function playAgain() {
            // Reset game state
            gameState = {
                currentRound: 0,
                animalsSorted: 0,
                startTime: new Date(),
                timerInterval: null,
                playerChoices: [],
                shuffledAnimals: []
            };
            
            // Reset UI
            elements.animalsSorted.textContent = '0';
            elements.timeElapsed.textContent = '0:00';
            
            // Show game screen
            elements.resultsScreen.classList.add('hidden');
            elements.resultsScreen.style.display = 'none';
            elements.gameScreen.classList.remove('hidden');
            
            // Restart timer
            clearInterval(gameState.timerInterval); // Clear old timer before starting a new one
            gameState.timerInterval = setInterval(updateTimer, 1000);
            
            // Start first round
            startRound(0);
        }

        // Share results
        function shareResults() {
            const personalityType = elements.personalityType.textContent;
            const time = elements.timeElapsed.textContent;
            
            const shareText = `I got "${personalityType}" on the Animal Personality Test! Can you guess what animal personality you are?`;

            if (navigator.share) {
                navigator.share({
                    title: 'Animal Personality Test Result',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                // Fallback: copy to clipboard
                const textArea = document.createElement('textarea');
                // FIX: Used template literal for the value
                textArea.value = `${shareText}\n\nTake the test: ${window.location.href}`;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    alert('Results copied to clipboard!');
                } catch (err) {
                    alert('Could not copy results to clipboard.');
                }
                document.body.removeChild(textArea);
            }
        }

        // Tutorial functions
        function skipTutorial() {
            elements.tutorialOverlay.style.display = 'none';
            elements.skipTutorial.classList.add('hidden');
        }

        function startTutorial() {
            elements.tutorialOverlay.style.display = 'none';
            elements.skipTutorial.classList.add('hidden');
        }

        // Initialize the game when the page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>